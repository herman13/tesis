\tikzstyle{decision} = [diamond, draw, fill=blue!20, text width=8em, text badly centered, node distance=3cm, inner sep=0pt]
\tikzstyle{block} = [rectangle, draw, fill=blue!20, text width=8em, text centered, rounded corners, minimum height=4em]
\tikzstyle{block1} = [rectangle, draw, fill=blue!20, text width=8em, text centered, rounded corners, minimum height=4em, node distance=3cm]
\tikzstyle{line} = [draw, -latex']
\tikzstyle{cloud1} = [draw, ellipse,fill=red!20, node distance=3cm, minimum height=2em]
\tikzstyle{cloud} = [draw, ellipse,fill=red!20, node distance=5cm, minimum height=2em]
\tikzstyle{cloud2} = [draw, ellipse,fill=red!20, node distance=7cm, minimum height=2em]


\begin{tikzpicture}[scale=2, node distance = 2cm, auto]
    % Place nodes

    % Entradas de datos


    \node [block] (interpolacion){ Interpolación };

    \node [cloud, left of=interpolacion] (contexto) {Contextos};
    \node [cloud, right of=interpolacion] (metricas) {Métricas};

  
    \node [block, below of=interpolacion] (fuzzyficacion){ \textit{Fuzzificación} };
    \node [block, below of=fuzzyficacion] (reglas){ Reglas de inferencia };
    \node [block, below of=reglas] (inferencia){ Inferencia };
    \node [block, below of=inferencia] (defuzzificacion){ \textit{Defuzzificación} };

    \node [block, below of=defuzzificacion] (promedio){ Promedio de notas };

    \node [decision, below of=promedio] (decision) {¿Hay suficiente información?};
    \node [cloud2, right of=decision] (nocambio) {No se cambia el protocolo};
    \node [block1, below of=decision] (seleccion) {Elegir mayor promedio};
    \node [cloud1, below of=seleccion] (cambio) {Cambiar protocolo};


    %\node [block] (init) {initialize model};
    %\node [cloud, left of=init] (expert) {expert};
    %\node [cloud, right of=init] (system) {system};
    %\node [block, below of=init] (identify) {identify candidate models};
    %\node [block, below of=identify] (evaluate) {evaluate candidate models};
    %\node [block, left of=evaluate, node distance=2.5cm] (update) {update model};
    %\node [decision, below of=evaluate] (decide) {is best candidate better?};
    %\node [block, below of=decide, node distance=2.5cm] (stop) {stop};

    \path [line, dashed] (contexto) -- (interpolacion);
    \path [line, dashed] (metricas) -- (interpolacion);
    \path [line] (interpolacion) -- (fuzzyficacion);
    \path [line] (fuzzyficacion) -- (reglas);
    \path [line] (reglas) -- (inferencia);
    \path [line] (inferencia) -- (defuzzificacion);
    \path [line] (defuzzificacion) -- (promedio);
    \path [line] (promedio) -- (decision);
    \path [line, dashed] (decision) -- node [, color=black] {no}(nocambio);
    \path [line] (decision) -- node [, color=black] {si}(seleccion);
    \path [line, dashed] (seleccion) -- (cambio);


    % Draw edges
    %\path [line] (init) -- (identify);
    %\path [line] (identify) -- (evaluate);
    %\path [line] (evaluate) -- (decide);
    %\path [line] (decide) -| node [near start, color=black] {yes} (update);
    %\path [line] (update) |- (identify);
    %\path [line] (decide) -- node [, color=black] {no}(stop);
    %\path [line,dashed] (expert) -- (init);
    %\path [line,dashed] (system) -- (init);
    %\path [line,dashed] (system) |- (evaluate);
\end{tikzpicture}
